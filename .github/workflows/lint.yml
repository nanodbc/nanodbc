# GHA workflow to check well-formedness of sources, docs and auxiliary files
name: "Lint"

on:
  push:
    branches:
    - main
  pull_request:

jobs:
  sources:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        path:
          - 'nanodbc'
          - 'test'
          - 'example'
    steps:
    - uses: actions/checkout@v3
    - uses: jidicula/clang-format-action@v4.10.1
      with:
        clang-format-version: '5.0'
        check-path: ${{ matrix.path }}
  documentation:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: avto-dev/markdown-lint@v1
      with:
        args: '**/*.md'
    - uses: docker://oskarstark/doctor-rst
      with:
        args: --short --error-format=github
      env:
        DOCS_DIR: 'doc/'
  docker:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: hadolint/hadolint-action@v2.0.0
      with:
        dockerfile: Dockerfile
  vagrant:
    runs-on: macos-10.15
    steps:
    - uses: actions/checkout@v3
    - run: vagrant version
    - run: vagrant validate
